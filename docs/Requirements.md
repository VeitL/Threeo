# HealthApp4 需求文档

## 1. 项目概述
HealthApp4 是一个全方位的健康追踪应用，支持多类型实体管理（人类、宠物、植物），帮助用户在一个统一的界面中管理不同类型的健康数据和日常记录。

## 2. 核心架构设计

### 2.1 主页设计原则
- **统一主页**：应用启动时直接显示主页，由各种功能卡片组成
- **类别筛选**：左上角类别切换器，支持在人类/宠物/植物三个默认类别间快速切换
- **卡片过滤**：右下角悬浮按钮，可以自定义显示哪些卡片
- **成员管理**：每个类别下可以添加多个成员实例

### 2.2 用户架构
- **三大类别**：人类、宠物、植物
- **成员实例**：
  - 人类类别：可以添加家庭成员（爸爸、妈妈、孩子等）
  - 宠物类别：可以添加不同宠物（猫咪、狗狗等）
  - 植物类别：可以添加不同植物（绿萝、多肉等）
- **数据隔离**：每个成员实例拥有独立的数据记录

## 3. 功能卡片系统

### 3.1 人类类别卡片
- **健康数据卡片**：集成Apple HealthKit数据
  - 步数、心率、体重、睡眠、血压、血糖
  - 支持数据可视化和历史记录
- **心情记录卡片**：快速记录当天心情状态
- **用药记录卡片**：药物管理和提醒功能
- **过敏记录卡片**：过敏反应快速记录（鼻子、眼睛、皮肤等症状）
- **甲状腺记录卡片**：症状记录（疲惫感、心情、脱发、排便情况等）

### 3.2 宠物类别卡片
- **体重记录卡片**：宠物体重追踪和管理
- **疫苗记录卡片**：疫苗接种记录和提醒

### 3.3 植物类别卡片
- **浇水记录卡片**：植物浇水记录和提醒
- **施肥记录卡片**：施肥记录和计划管理
- **生长记录卡片**：植物生长状态记录

### 3.4 卡片通用功能
- **快速记录**：每个卡片支持快速数据录入
- **动画反馈**：保存成功后显示动画提示
- **详细视图**：点击卡片进入详细数据管理界面
- **数据可视化**：支持图表展示和历史数据查看

## 4. 用户界面设计

### 4.1 主页布局
```
┌─────────────────────────────────────┐
│ [类别] [当前用户]    [用户] [管理] │  工具栏
├─────────────────────────────────────┤
│                                     │
│  ┌─────────┐  ┌─────────┐           │
│  │ 卡片 1  │  │ 卡片 2  │           │  卡片区域
│  └─────────┘  └─────────┘           │
│                                     │
│  ┌─────────┐  ┌─────────┐           │
│  │ 卡片 3  │  │ 卡片 4  │           │
│  └─────────┘  └─────────┘           │
│                                 [⚙] │  悬浮按钮
└─────────────────────────────────────┘
```

### 4.2 操作流程
1. **启动应用** → 直接显示主页
2. **类别切换** → 点击左上角类别按钮
3. **成员切换** → 点击当前用户头像
4. **卡片管理** → 点击右下角悬浮按钮
5. **数据记录** → 直接在卡片上操作

## 5. 技术实现要求

### 5.1 数据存储
- **本地存储**：Core Data / SQLite
- **数据结构**：
  ```
  Category (人类/宠物/植物)
  ├── Members (成员列表)
  │   ├── Profile (个人信息)
  │   └── Records (记录数据)
  └── CardConfigs (卡片配置)
  ```

### 5.2 HealthKit集成
- **授权管理**：优雅处理权限请求
- **数据同步**：定期同步健康数据
- **错误处理**：处理数据缺失或授权失败情况

### 5.3 用户体验
- **快速切换**：类别和成员切换动画流畅
- **状态保持**：记住用户上次的选择
- **离线支持**：核心功能无需网络连接

## 6. 开发优先级

### Phase 1 (核心功能)
- [x] 基础架构搭建
- [x] 三类别系统实现
- [x] 卡片显示和过滤
- [x] 成员管理功能

### Phase 2 (功能完善)
- [ ] HealthKit数据优化
- [ ] 数据记录和存储
- [ ] 通知和提醒功能
- [ ] 数据可视化

### Phase 3 (用户体验)
- [ ] 动画和过渡效果
- [ ] 深色模式支持
- [ ] 多语言本地化
- [ ] 数据导入导出

## 7. 质量保证

### 7.1 性能要求
- 启动时间 < 2秒
- 卡片切换动画流畅（60fps）
- 内存使用控制在合理范围

### 7.2 稳定性要求
- 处理HealthKit授权失败
- 优雅处理数据缺失
- 防止应用崩溃

### 7.3 用户体验要求
- 界面操作直观易懂
- 错误提示友好明确
- 数据备份和恢复机制

## 8. 未来扩展

### 8.1 云同步功能
- iCloud数据同步
- 多设备数据一致性
- 家庭共享功能

### 8.2 智能功能
- 健康趋势分析
- 智能提醒建议
- 数据关联分析

### 8.3 社交功能
- 家庭成员数据共享
- 医生数据分享
- 社区交流功能

## 合规要求
- 符合 GDPR 数据保护要求
- 获取必要的用户授权
- 提供数据删除功能
- 隐私政策和用户协议
- 数据加密存储 
